#include <windows.h>
#include <stdio.h>

#define okay(msg, ...) printf("[+] " msg "\n", ##__VA_ARGS__)
#define warn(msg, ...) printf("[-] " msg "\n", ##__VA_ARGS__)
#define info(msg, ...) printf("[i] " msg "\n", ##__VA_ARGS__)

int main(void) {

    HMODULE hDll = NULL;
    char dllPath[MAX_PATH] = "dynamicLinkLibrary.dll";

    info("Trying to get a handle to %s", dllPath);

    hDll = LoadLibrary(dllPath);

    if (hDll == NULL) {
        warn("Failed to get a handle to %s, Error: 0x%lx", dllPath, GetLastError());        
        return EXIT_FAILURE;
    }

    okay("Got a handle to %s!", dllPath);
    info("\\---0x%p", hDll);

    info("Freeing the module");

    FreeLibrary(hDll);

    okay("Finished, Press <enter> to exit");

    getchar();

    return EXIT_SUCCESS;

}